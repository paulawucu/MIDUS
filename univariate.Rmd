---
title: "univariate"
author: "Paula Wu"
date: "6/9/2022"
geometry: margin=2cm
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(patchwork)
library(caret)
library(GGally)
library(nlme)
library(lme4)
library(stringr)
library(stargazer)
library(factoextra)
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
theme_set(theme_minimal() + theme(legend.position = "bottom") + theme(plot.title = element_text(hjust = 0.5)))
```
```{r, results='asis'}
full_df_no_invalid = read.csv("./data/full_df.csv") %>% 
  select(-1)

# 1 for white, 2 for non-white
full_df_lm = full_df_no_invalid %>% 
  mutate(B1PF7A = ifelse(as.numeric(B1PF7A) != 1, 2, as.numeric(B1PF7A)),
         B1PF7A = as.factor(B1PF7A),
         B1PB1 = as.factor(B1PB1),
         B1SA62T = B1SA62A + B1SA62B + B1SA62C + B1SA62D + B1SA62E + B1SA62F + B1SA62G + B1SA62H + B1SA62I + B1SA62J)

```
```{r, results='asis'}
# include education: SES is significantly correlated with both M2 and M3 composite scores but not the difference
# exclude education: SES is significantly correlated with D3TCOMP and D3TEF but not D3TEM
d_comp_lm = lm(D3TCOMP ~ B1PAGE_M2 + B1PRSEX + B1PF7A +  B1PTSEI + D1PB19 + B1PA39 + B4HMETMW + B1SA11W + B4ALCOH + B1SA62A + B1SA62B + B1SA62C + B1SA62D + B1SA62E + B1SA62F + B1SA62G + B1SA62H + B1SA62I + B1SA62J, data = full_df_lm)
d_em_lm = lm(D3TEM ~ B1PAGE_M2 + B1PRSEX + B1PF7A + B1PTSEI + D1PB19 + B1PA39 + B4HMETMW + B1SA11W + B4ALCOH + B1SA62A + B1SA62B + B1SA62C + B1SA62D + B1SA62E + B1SA62F + B1SA62G + B1SA62H + B1SA62I + B1SA62J, data = full_df_lm)
d_ef_lm = lm(D3TEF ~ B1PAGE_M2 + B1PRSEX + B1PF7A + B1PTSEI + D1PB19 + B1PA39 + B4HMETMW + B1SA11W + B4ALCOH + B1SA62A + B1SA62B + B1SA62C + B1SA62D + B1SA62E + B1SA62F + B1SA62G + B1SA62H + B1SA62I + B1SA62J, data = full_df_lm)
ctq_lm = lm(ctq_total ~ B1PAGE_M2 + B1PRSEX + B1PF7A + B1PTSEI + D1PB19 + B1PA39 + B4HMETMW + B1SA11W + B4ALCOH + B1SA62A + B1SA62B + B1SA62C + B1SA62D + B1SA62E + B1SA62F + B1SA62G + B1SA62H + B1SA62I + B1SA62J, data = full_df_lm)


stargazer(d_comp_lm,d_em_lm, d_ef_lm, ctq_lm,
  type = 'latex',
  header = FALSE,
  notes.label = "Significance levels",
  #title = "Results of 5 Regression Models",
#  column.labels = c("Model 1", "Model 2", "Model 3", "Model 4", "Model 5"),
  # colnames = FALSE,
  # model.numbers = FALSE,
  # dep.var.caption = " ",
   #keep.stat = c("rsq")
  notes.align = "l",
single.row = TRUE, 
font.size = "small"
  )
table(full_df_lm$B1SA62J)
full_df_lm %>% 
  filter(B1SA62J == 1)
```

