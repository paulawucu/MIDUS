---
title: "investigations"
author: "Paula Wu"
date: "5/11/2022"
output: github_document
---

**7.7/7.14 Updates** (all updates are located at the bottom of this document):

1. Moderator effects of self-administered drugs are investigated and reported.

2. I also explored another method called "multivariate multilevel regression", which takes all three independent variables as the outcome variables while fitting other dependent variables as either predictors or covariates (details see below). 

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(patchwork)
library(caret)
library(GGally)
library(nlme)
library(lme4)
library(gee)
library(stringr)
library(stargazer)
library(MCMCglmm)
library(brms)
library(lmerTest)
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
theme_set(theme_minimal() + theme(legend.position = "bottom") + theme(plot.title = element_text(hjust = 0.5)))
```

```{r}
m2_df = 
  read_csv("./data/m2_df.csv") %>% 
  select(-1) %>% 
  filter(B3TCOMPZ3 != 8 & B3TEMZ3 != 8 & B3TEFZ3 != 8) %>% 
  filter(B4QCT_SA != 98 & B4QCT_EN != 98 & B4QCT_MD != 8 & B4QCT_PN != 98 & B4QCT_EA != 98 & B4QCT_PA != 98) %>% 
  select(-c(37:47))
```

```{r}

```

## SES and Spouse SES Investigation
For now, I'm thinking about impute those missing numbers with their spouse's SES, if any. First, investigate: how many people have their spouse's SES filled (out of 334)
```{r}
m2_df %>% 
  filter(B1PTSEI == 999) %>% 
  select(M2ID, M2FAMNUM, B1PTSEI, B1PTSEIS) %>% 
  mutate(nul = ifelse(B1PTSEIS == 999, 1, 0)) %>% 
  group_by(nul) %>% 
  summarize(n = n())
```
Out of 334 missing, 125 of them still don't have the spouse SES while 209 of them did. 

### imputation - Jun 2nd (final) version:
Impute spouses' SES for those who doesn't have SES; for the rest use LM (education as predictor) for imputation

```{r}
# for those whose spouse has a valid SES
with_sps = 
  m2_df %>% 
  filter(B1PTSEI == 999) %>% 
  select(M2ID, M2FAMNUM, B1PTSEI, B1PTSEIS) %>% 
  filter(B1PTSEIS != 999) %>% 
  pull(M2ID)
m2_df[m2_df$M2ID %in% with_sps, which(colnames(m2_df) == "B1PTSEI")] = m2_df[m2_df$M2ID %in% with_sps, which(colnames(m2_df) == "B1PTSEIS")]

# for those whose spouse doesn't have a valid SES, fit an LM 
m2_df_lm = m2_df %>% 
  select(B1PTSEI, B1PAGE_M2, B1PB1) %>% 
  filter(B1PTSEI != 999 & B1PB1 != 97)
lm_ses = lm(B1PTSEI ~ B1PB1, data = m2_df_lm)


# prediction
m2_pred_id = m2_df %>% 
  filter(B1PTSEI == 999) %>% 
  pull(M2ID)

for (i in m2_pred_id){
  edu = m2_df[m2_df$M2ID == i, which(colnames(m2_df) == "B1PB1")]
  pred_ses = predict(lm_ses, newdata = edu)
  m2_df[m2_df$M2ID == i, which(colnames(m2_df) == "B1PTSEI")] = pred_ses
}
```

```{r eval=FALSE}
m2_df_copy = m2_df
m2_df_invalid = 
  m2_df_copy %>% 
  mutate(B3TCOMPZ3_ = ifelse(B3TCOMPZ3 == 8, 1, 0),
         B3TEMZ3_ = ifelse(B3TEMZ3 == 8, 1, 0),
         B3TEFZ3_ = ifelse(B3TEFZ3 == 8, 1, 0),
         B4QCT_SA_ = ifelse(B4QCT_SA == 98, 1, 0),
         B4QCT_EN_ = ifelse(B4QCT_EN == 98, 1, 0),
         B4QCT_MD_ = ifelse(B4QCT_MD == 8, 1, 0),
         B4QCT_PN_ = ifelse(B4QCT_PN == 98, 1, 0),
         B4QCT_EA_ = ifelse(B4QCT_EA == 98, 1, 0),
         B4QCT_PA_ = ifelse(B4QCT_PA == 98, 1, 0),
         B1PTSEI_ = ifelse(B1PTSEI == 999, 1, 0),
         B4HMETMW_ = ifelse(B4HMETMW == 99998, 1, 0),
         B1PB1_ = ifelse(B1PB1 == 97, 1, 0),
         B1PF7A_ = ifelse(B1PF7A >= 7, 1, 0),
         B1SA62A_ = ifelse(B1SA62A == 8, 1, 0),
         B1SA62B_ = ifelse(B1SA62B == 8, 1, 0),
         B1SA62C_ = ifelse(B1SA62C == 8, 1, 0),
         B1SA62D_ = ifelse(B1SA62D == 8, 1, 0),
         B1SA62E_ = ifelse(B1SA62E == 8, 1, 0),
         B1SA62F_ = ifelse(B1SA62F == 8, 1, 0),
         B1SA62G_ = ifelse(B1SA62G == 8, 1, 0),
         B1SA62H_ = ifelse(B1SA62H == 8, 1, 0),
         B1SA62I_ = ifelse(B1SA62I == 8, 1, 0),
         B1SA62J_ = ifelse(B1SA62J == 8, 1, 0),
         B1SPWBA2_ = ifelse(B1SPWBA2 == 98, 1, 0),
         B1SPWBE2_ = ifelse(B1SPWBE2 == 98, 1, 0),
         B1SPWBG2_ = ifelse(B1SPWBG2 == 98, 1, 0),
         B1SPWBR2_ = ifelse(B1SPWBR2 == 98, 1, 0),
         B1SPWBU2_ = ifelse(B1SPWBU2 == 98, 1, 0),
         B1SPWBS2_ = ifelse(B1SPWBS2 == 98, 1, 0),
         B1SMASTE_ = ifelse(B1SMASTE == 8, 1, 0),
         B1SCONST_ = ifelse(B1SCONST == 8, 1, 0),
         B1SCTRL_ = ifelse(B1SCTRL == 8, 1, 0),
         B1SESTEE_ = ifelse(B1SESTEE == 98, 1, 0),
         B1SINTER_ = ifelse(B1SINTER == 8, 1, 0),
         BASINTER_ = ifelse(B1SINTER == 98, 1, 0),
         B1SINDEP_ = ifelse(B1SINDEP == 8, 1, 0),
         BASINDEP_ = ifelse(B1SINDEP == 98, 1, 0),
         B1SAGENC_ = ifelse(B1SAGENC == 8, 1, 0),
         B1SAGREE_ = ifelse(B1SAGREE == 8, 1, 0),
         B1SEXTRA_ = ifelse(B1SEXTRA == 8, 1, 0),
         B1SNEURO_ = ifelse(B1SNEURO == 8, 1, 0),
         B1SCONS1_ = ifelse(B1SCONS1 == 8, 1, 0),
         invalid_ind = NA) %>% 
  select(-c(2:60)) %>% 
  select(M2ID, invalid_ind, everything()) %>% 
  rename_at(.vars = vars(ends_with("_")),
            .funs = funs(sub("_$", "", .)))


for (i in 1:1099){
  obs = m2_df_invalid[i,]
  invalid_str = invalid_var(obs)
  m2_df_invalid[i,2] = invalid_str
}
invalid_full = 
  m2_df_invalid %>% 
  select(M2ID, invalid_ind) %>% 
  filter(!invalid_ind == "") %>% 
  mutate(invalid_count = str_count(invalid_ind, pattern = ","))

invalid_full %>% 
  group_by(invalid_count) %>% 
  summarize(n = n()) %>% 
  knitr::kable()

invalid_full %>% 
  ggplot(aes(x = invalid_count))+
  geom_histogram() +
  stat_bin(aes(y=..count.., label=ifelse(..count..== 0,"",..count..)), geom="text", vjust= -0.5)
```

```{r eval= FALSE}
a = m2_df %>% 
  filter(!(B4QCT_EA == 98 | B4QCT_EN == 98 | B4QCT_SA == 98 | B4QCT_PA == 98 | B4QCT_PN == 98 | B4QCT_MD == 8 )) %>% 
  mutate(ctq_total = B4QCT_EA + B4QCT_EN + B4QCT_SA + B4QCT_PA + B4QCT_PN + B4QCT_MD)

mean_ctq = a %>% 
  pull(ctq_total) %>% 
  mean() %>% 
  signif(6)

median_ctq = a %>% 
  pull(ctq_total) %>% 
  median() %>% 
  signif(6)

a %>% 
  ggplot(aes(x = ctq_total)) +
  geom_density()+
  geom_vline(xintercept=mean_ctq, size=0.5, color="red")+
  geom_text(aes(x=mean_ctq + 5, label=paste0("Mean\n",mean_ctq), y=0.03), color = "red")+
  geom_vline(xintercept=median_ctq, size=0.5, color="blue")+
  geom_text(aes(x=median_ctq - 3, label=paste0("Median\n",median_ctq), y=0.03), color = "blue")+
  theme(legend.position = "none")+
  xlab("CTQ Total Score")+
  ylab("Density")

a %>% 
  mutate(below_49 = ifelse(ctq_total <= 39, 1, 0)) %>% 
  group_by(below_49) %>% 
  summarize(n = n())
#ggsave("ctq_density.jpeg", width = 10, height = 7)
```
## Invalid investigation, after imputation
```{r}
m2_df_cc = m2_df %>% 
  mutate(B1PTSEI_ = ifelse(B1PTSEI == 999, 1, 0),
         B4HMETMW_ = ifelse(B4HMETMW == 99998, 1, 0),
         B1PB1_ = ifelse(B1PB1 == 97, 1, 0),
         B1PF7A_ = ifelse(B1PF7A >= 7, 1, 0),
         B1SA62A_ = ifelse(B1SA62A == 8, 1, 0),
         B1SA62B_ = ifelse(B1SA62B == 8, 1, 0),
         B1SA62C_ = ifelse(B1SA62C == 8, 1, 0),
         B1SA62D_ = ifelse(B1SA62D == 8, 1, 0),
         B1SA62E_ = ifelse(B1SA62E == 8, 1, 0),
         B1SA62F_ = ifelse(B1SA62F == 8, 1, 0),
         B1SA62G_ = ifelse(B1SA62G == 8, 1, 0),
         B1SA62H_ = ifelse(B1SA62H == 8, 1, 0),
         B1SA62I_ = ifelse(B1SA62I == 8, 1, 0),
         B1SA62J_ = ifelse(B1SA62J == 8, 1, 0),
         B1SPWBA2_ = ifelse(B1SPWBA2 == 98, 1, 0),
         B1SPWBE2_ = ifelse(B1SPWBE2 == 98, 1, 0),
         B1SPWBG2_ = ifelse(B1SPWBG2 == 98, 1, 0),
         B1SPWBR2_ = ifelse(B1SPWBR2 == 98, 1, 0),
         B1SPWBU2_ = ifelse(B1SPWBU2 == 98, 1, 0),
         B1SPWBS2_ = ifelse(B1SPWBS2 == 98, 1, 0),
         invalid_ind = NA) %>% 
  select(-c(2:49)) %>% 
  select(M2ID, invalid_ind, everything()) %>% 
  rename_at(.vars = vars(ends_with("_")),
            .funs = funs(sub("_$", "", .)))

invalid_var = function(obs){
  invalid_str = ""
  for (i in 3:22){
    cell = as.numeric(obs[i])
    if(cell == 1){
      invalid_str = paste0(invalid_str, colnames(obs)[i], sep = ", ")
    }
  }
  return(invalid_str)
}
for (i in 1:1099){
  obs = m2_df_cc[i,]
  invalid_str = invalid_var(obs)
  m2_df_cc[i,2] = invalid_str
}
invalid_cc = 
  m2_df_cc %>% 
  select(M2ID, invalid_ind) %>% 
  filter(!invalid_ind == "") %>% 
  mutate(invalid_count = str_count(invalid_ind, pattern = ","))

# quick summary: invalid entries of each variable
colSums(m2_df_cc[3:22])

# quick summary: count of people for different numbers of invalid entries. Total: 40 subjects
invalid_cc %>%
  group_by(invalid_count) %>% 
  summarize(n = n()) %>% 
  bind_rows(summarise_all(., ~if(is.numeric(.)) sum(.) else "Total")) %>% 
  mutate(invalid_count = ifelse(row_number() == 6, "Total", invalid_count)) %>% 
  knitr::kable()
```

```{r}
# deselect unnecessary variables, deselect invalid entries
invalid_cc_id = invalid_cc %>% 
  pull(M2ID) %>% 
  unique()

m2_df = m2_df %>% 
  select(-c(B3PIDATE_MO, B3PIDATE_YR, B1PTSEIS, B1PA37, B1PA38A, B1SA11Z, B4H33, B4H34, B4H36, B4H38, B4H40)) %>% 
  filter(!(M2ID %in% invalid_cc_id))
  
```

# M3 dataframe
```{r}
m2_id = m2_df %>% pull(M2ID)
length(m2_id)

m3_df = 
  read_csv("./data/m3_df.csv") %>% 
  select(-1)


# only 911 left after joining, the rest 165 don't have M3 record
# 867 left after filtering out invalid entries
full_df = 
  inner_join(m2_df, m3_df, by = "M2ID") %>% 
  select(-M2FAMNUM.y) %>% 
  rename(M2FAMNUM = M2FAMNUM.x) %>%
  filter(C3TCOMP != 8 & C3TEM != 8 & C1PA6A != 7) %>% 
  mutate(D3TCOMP = C3TCOMP - B3TCOMPZ3,
         D3TEM = C3TEM - B3TEMZ3,
         D3TEF = C3TEF - B3TEFZ3,
         D1PB19 = C1PB19 - B1PB19,
         B1PF7A = as.factor(B1PF7A),
         B1PA39 = as.factor(B1PA39))
```
```{r}

```


# Univariate Analysis

### Univariate Analysis of Cognition, CTQ total
```{r}
joined_date = read_csv("./data/time_lasped.csv") %>% 
  mutate(yr_lapsed = lapsed/12) %>% 
  select(M2ID, yr_lapsed)  # year lapsed
```

```{r}
full_df_no_invalid = full_df %>% 
  mutate(ctq_total = B4QCT_EA + B4QCT_EN + B4QCT_SA + B4QCT_PA + B4QCT_PN + B4QCT_MD,
         B1PRSEX = as.factor(B1PRSEX),
         B4ALCOH = factor(B4ALCOH, levels = c("former_light/abs", "former_moderate", "former_heavy", "current_light", "current_moderate", "current_heavy")),
         D1PB19 = factor(D1PB19, levels = c(0,-1, 1)),
         B1PF7A = ifelse(as.numeric(B1PF7A) != 1, 2, as.numeric(B1PF7A)),
         B1PF7A = as.factor(B1PF7A),
         B1PA39 = recode_factor(B1PA39, `9` = "non_smoker", `2` = "former_smoker", `1` = "current_smoker"),
         D1PA6A = factor(ifelse((C1PA6A - B1PA6A) == -1, 1, 0), levels = c(0,1)),
         B1SA11W = ifelse(B1SA11W == 2, 0, 1),
         B1SA62A = ifelse(B1SA62A == 2, 0, 1),
         B1SA62B = ifelse(B1SA62B == 2, 0, 1),
         B1SA62C = ifelse(B1SA62C == 2, 0, 1),
         B1SA62D = ifelse(B1SA62D == 2, 0, 1),
         B1SA62E = ifelse(B1SA62E == 2, 0, 1),
         B1SA62F = ifelse(B1SA62F == 2, 0, 1),
         B1SA62G = ifelse(B1SA62G == 2, 0, 1),
         B1SA62H = ifelse(B1SA62H == 2, 0, 1),
         B1SA62I = ifelse(B1SA62I == 2, 0, 1),
         B1SA62J = ifelse(B1SA62J == 2, 0, 1),
         thr_total = B4QCT_EA + B4QCT_SA + B4QCT_PA,
         dep_total = B4QCT_EN + B4QCT_PN + B4QCT_MD,
  )
#write.csv(full_df_no_invalid, "./data/full_df.csv")

# scaling age, SES, modifiers (?), exercise
full_df_no_invalid =  full_df_no_invalid %>% 
  mutate(B1SA11W = as.factor(B1SA11W),
         B1SA62A = as.factor(B1SA62A),
         B1SA62B = as.factor(B1SA62B),
         B1SA62C = as.factor(B1SA62C),
         B1SA62D = as.factor(B1SA62D),
         B1SA62E = as.factor(B1SA62E),
         B1SA62F = as.factor(B1SA62F),
         B1SA62G = as.factor(B1SA62G),
         B1SA62H = as.factor(B1SA62H),
         B1SA62I = as.factor(B1SA62I),
         B1SA62J = as.factor(B1SA62J)) %>% 
   mutate_each_(funs(scale(.)), c(6,10,25:30, 37)) %>% 
  select(-D1PA6A) 

full_df_no_invalid = left_join(full_df_no_invalid, joined_date, by = "M2ID")
# sum(is.na(joined_date$yr_lapsed)==TRUE) # no invalid
full_df_no_invalid = full_df_no_invalid %>% 
  mutate(D3TCOMPR = D3TCOMP/yr_lapsed,
         D3TEMR = D3TEM/yr_lapsed,
         D3TEFR = D3TEF/yr_lapsed)
```

```{r}
#write.csv(full_df_no_invalid, "./data/full_df_inval.csv")
```


# Modeling

I completely filter out all the observations with at least one invalid feature, in total there are 23 of them, which is an arbitrarily small number. 

first, fit the model with a list of covariates

* ctq total score
* age
* sex
* race
* education (or SES)
* (imputed) SES
* changes in marital status
* changes in stroke (deleted 9.28)
* smoking, drug use, alcohol consumption
* exercise and chronic sleep problem


## Multilevel Models

*What is the multilevel?*

First, the reason we would like to use multilevel modeling is because we have measured the same participants multiple times, and there are correlation within subjects that we cannot ignore.

The **assumption** we were making when constructing the model is: participants from different families would have different intercepts of cognitive functioning at the baseline (i.e. having different intercept). We may expect each family has some differences that affects the intercept but not the slope (all families will have the same rate of change throughout time), and that members of the same family would share the same baseline cognitive functioning. 

*What would the model be like?*
In Dr. Lachman's paper, we have seen that they used multilevel models to evaluate different predictors of both level of and change in cognitive functioning. They have defined a model with level 1 slope (non time-varying) and level 2 random intercept (different baseline for each family). However, one thing I have understood wrong is the equation: It's not necessarily true that we put two predictor on the LHS of the equation as independent variables and called it multilevel modeling. We are, indeed, predicting both level and intercept, but the model itself will yield fitted results of intercept and slope. We are still predicting one independent variable: change in composite score, episodic memory, or executive functioning. The slopes and intercepts are by-products of the modeling. More specifically, the models are fitted using maximum-likelihood.


*Thinking about the change per month/years*

Last time, we've seen that there's a huge variance associated with the elapsed time between M2 and M3 for the population. Thus, maybe we would like to move from the "change in magnitude" to "rate of change per year or per month". In this case, I don't think we still need to index the baseline. Or, I could include the time between M2 and M3 as a covariate. (10.10 updates: go for the second option)

*What are the variables included in the model?*

Dependent variable: 

* D3TCOMP: change in composite scores
* D3TEM: change in episodic memory
* D3TEF: change in executive functioning

Independent variable:

* B3TCOMPZ3, B3TEFZ3, B3TEMZ3: three baseline variables (of cognitive functioning) measured at M2
* M2FAMNUM: family number
* yr_lapsed: years between M2 and M3 for each participants
* B1PRSEX: sex, male = 1 (reference), female = 2
* B1PAGE_M2: age measured at M2
* B1PF7A: racial origin, white = 1 (reference), non-white = 2
* B1PTSEI: SES
* B1PA39: cigarette smoking, reference: non_smoker
* B4ALCOH: alcohol drinking, reference: former_light/abs
* D1PB19: marital status change. 0 = no change (reference), -1 = divorce or equivalent, 1 = married
* B4HMETMW: exercise minutes per week
* B1SA11W: chronic sleep problem in the past 12 months 


### random intercept model - CTQ Total Scores (the very basic)

Change in Composite Scores
```{r} 
lmm_model1_cs <- lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + (1|M2FAMNUM) + yr_lapsed, REML = FALSE, data = full_df_no_invalid)  # random intercept vary across families about 0.053
summary(lmm_model1_cs)
```

Change in Episodic Memory
```{r}
lmm_model1_em <- lmer(D3TEM ~ B3TEMZ3 + ctq_total + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
summary(lmm_model1_em)
```

Change in Executive Functioning
```{r}
lmm_model1_ef <- lmer(D3TEF ~ B3TEFZ3 + ctq_total + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
summary(lmm_model1_ef)
```


### Add covariates

Change in Composite Scores
```{r}
lmm_model2_cs <- lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm_model1_cs, lmm_model2_cs)
```

```{r}
summary(lmm_model2_cs)
```


Change in Episodic Memory
```{r}
lmm_model2_em <- lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm_model1_em, lmm_model2_em)
```

```{r}
summary(lmm_model2_em)
```

Change in Executive Functioning
```{r}
lmm_model2_ef <- lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm_model1_ef, lmm_model2_ef)
```

```{r}
summary(lmm_model2_ef)
```

**Interpretation:**

Take the last table for example (dependent variable: change in EF): 

|                         |Estimate|   Std. Error|       df|   t value| Pr(>$|t|$)|
|---------:|-------:|-------:|-------:|--------:|---------------:|
|B1PAGE_M2              | -1.365e-01|  1.619e-02 | 7.742e+02 | -8.427 | < 2e-16 ***|
|B1PTSEI                |  4.136e-02 | 1.525e-02 | 8.568e+02 |  2.712 | 0.006821 ** |

My interpretation is: age significantly predicts the change in executive functioning, i.e. on average (and control all other covariates), 1 year increase of age will result in 0.137 more decline in Executive Functioning scores. Similarly, SES significantly predicts the change in executive functioning, i.e. on average, 1 unit change in SES will result in 0.0414 change in the positive direction in the Executive Functioning scores. 

For those insignificant results, the interpretation will thus be: the <independent variable> did not significantly predict the <dependent variable>. For example, the ctq_total did not significantly predict the change in executive functioning.

### Threat and deprivation

**threat**

Change in Composite Scores & threat
```{r}
lmm_model2_cs_thr <- lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_cs_thr)
```


Change in Episodic Memory
```{r}
lmm_model2_em_thr <- lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_em_thr)
```

Change in Executive Functioning
```{r}
lmm_model2_ef_thr <- lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_ef_thr)
```

**deprivation**

Change in Composite Scores
```{r}
lmm_model2_cs_dep <- lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_cs_dep)
```


Change in Episodic Memory
```{r}
lmm_model2_em_dep <- lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_em_dep)
```

Change in Executive Functioning
```{r}
lmm_model2_ef_dep <- lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
```

```{r}
summary(lmm_model2_ef_dep)
```


Check model assumptions
```{r}
plot(lmm_model2_cs, main = "Change in Composite Scores: resid vs. fitted")
plot(lmm_model2_em, main = "Change in Episodic Memory: resid vs. fitted")
plot(lmm_model2_ef, main = "Change in Executive Function: resid vs. fitted")
```


# Modifiers: eudaimonia effect

* Stratified analysis can be one way to analyze the effect modification; however, as this analysis is usually done in a 2-by-2 table, we either need dichotomous variables (e.g. sex) or an arbitrary cutoff point for continuous variables. In later analysis, we included the modifiers as the interaction term.


The following part is to investigate whether adding an interaction term will improve the model fit. Use **likelihood-ratio test** for model comparison. Also, since we are comparing nested models (meaning one model is nested in another), and we are generally interested in the mean coefficients $\beta$, we should use maximum likelihood (ML) 


**What are the interaction terms?**

We are interested in investigating how these eudaimonia factors have interacted with the childhood trauma. Thus, the interaction term included in the larger model should be **<trauma total score>$\times$<eudaimonia terms>**. I also refit the nested/smaller model by adding the eudaimonia terms as the covariate. Similarly, the same term was also added to the larger model. Thus, when we comparing models, we are truly comparing the effect modification of eudaimonia factors on childhood trauma rather than introducing a new term to the model that has never seen beforehand.

## Results 

Unfortunately, none of the interaction term between ctq_total/thr_total/dep_total and eudaimonia terms has been found to statistically significantly increase the power of the model. 


## CTQ total

Autonomy (B1SPWBA2)
```{r}
# Composite
lmm1_1 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_autonomy = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + ctq_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_1, lmm1_autonomy)

# EM
lmm2_1 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_autonomy = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + ctq_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_1, lmm2_autonomy)

# EF
lmm3_1 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed+ B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_autonomy = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + ctq_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_1, lmm3_autonomy)
```

**Interpretation**

Suppose we have the following model comparison:

|           |  npar|   AIC|    BIC|  logLik| deviance|  Chisq| Df| Pr(>Chisq)|
|----------:|----:|----:|----:|----:|------:|------------:|------------:|---------:|         
|lmm1_1     |     22| 873.42| 978.25| -414.71|829.42| | |          
|lmm1_autonomy|   23| 874.94| 984.54| -414.47|   828.94| 0.4761|  1|     0.4902

The first 5 columns are statistics regarding each model while the last 3 columns are related to model comparisons. "Chisq" computes the $\chi^2$ statistics for model comparisons. "Df" means the different in degrees of freedom between the model we would like to compare. Since we only added one interaction term, the $\Delta Df$ is 1. Lastly, "Pr(>Chisq)" gave us the p-value of whether the interaction term added to the model has improved the model prediction significantly. In the example shown above, $0.4902>>0.05$, we failed to reject the null and have to conclude that the interaction term isn't significant.


Environmental Mastery (B1SPWBE2)
```{r}
# Composite
lmm1_2 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_mastery = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + ctq_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_2, lmm1_mastery)

# EM
lmm2_2 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_mastery = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + ctq_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_2, lmm2_mastery)

# EF
lmm3_2 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_mastery = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + ctq_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_2, lmm3_mastery)

```



Personal Growth (B1SPWBG2)
```{r}
# Composite
lmm1_3 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pg= lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + ctq_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_3, lmm1_pg)


# EM
lmm2_3 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pg = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + ctq_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_3, lmm2_pg)


# EF
lmm3_3 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pg = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + ctq_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_3, lmm3_pg)
```

Positive Relations with Others (B1SPWBR2)
```{r}
# Composite
lmm1_4 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pr = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + ctq_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_4, lmm1_pr)


# EM
lmm2_4 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pr = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + ctq_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_4, lmm2_pr)

# EF
lmm3_4 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pr = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + ctq_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_4, lmm3_pr)
```

Purpose in Life (B1SPWBU2)
```{r}
# Composite
lmm1_5 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pl = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + ctq_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_5, lmm1_pl)


# EM
lmm2_5 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pl = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + ctq_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_5, lmm2_pl)

# EF
lmm3_5 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pl = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + ctq_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_5, lmm3_pl)
```


Self-Acceptance (B1SPWBS2)
```{r}
# Composite
lmm1_6 = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_sa = lmer(D3TCOMP ~ B3TCOMPZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + ctq_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_6, lmm1_sa)


# EM
lmm2_6 = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_sa = lmer(D3TEM ~ B3TEMZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + ctq_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_6, lmm2_sa)

# EF
lmm3_6 = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_sa = lmer(D3TEF ~ B3TEFZ3 + ctq_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + ctq_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_6, lmm3_sa)
```


## Threat


Autonomy (B1SPWBA2)
```{r}
# Composite
lmm1_1_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_autonomy_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + thr_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_1_tr, lmm1_autonomy_tr)

# EM
lmm2_1_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_autonomy_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2+  thr_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_1_tr, lmm2_autonomy_tr)

# EF
lmm3_1_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed+ B1SPWBA2+ (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_autonomy_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + thr_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_1_tr, lmm3_autonomy_tr)
```

Environmental Mastery (B1SPWBE2)
```{r}
# Composite
lmm1_2_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_mastery_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + thr_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_2_tr, lmm1_mastery_tr)

# EM
lmm2_2_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_mastery_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + thr_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_2_tr, lmm2_mastery_tr)

# EF
lmm3_2_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_mastery_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + thr_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_2_tr, lmm3_mastery_tr)

```



Personal Growth (B1SPWBG2)
```{r}
# Composite
lmm1_3_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pg_tr= lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + thr_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_3_tr, lmm1_pg_tr)


# EM
lmm2_3_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pg_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + thr_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_3_tr, lmm2_pg_tr)


# EF
lmm3_3_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pg_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + thr_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_3_tr, lmm3_pg_tr)
```

Positive Relations with Others (B1SPWBR2)
```{r}
# Composite
lmm1_4_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pr_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + thr_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_4_tr, lmm1_pr_tr)


# EM
lmm2_4_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pr_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + thr_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_4_tr, lmm2_pr_tr)

# EF
lmm3_4_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pr_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + thr_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_4_tr, lmm3_pr_tr)
```

Purpose in Life (B1SPWBU2)
```{r}
# Composite
lmm1_5_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pl_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + thr_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_5_tr, lmm1_pl_tr)


# EM
lmm2_5_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pl_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + thr_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_5_tr, lmm2_pl_tr)

# EF
lmm3_5_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pl_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + thr_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_5_tr, lmm3_pl_tr)
```


Self-Acceptance (B1SPWBS2)
```{r}
# Composite
lmm1_6_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_sa_tr = lmer(D3TCOMP ~ B3TCOMPZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + thr_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_6_tr, lmm1_sa_tr)


# EM
lmm2_6_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_sa_tr = lmer(D3TEM ~ B3TEMZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + thr_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_6_tr, lmm2_sa_tr)

# EF
lmm3_6_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_sa_tr = lmer(D3TEF ~ B3TEFZ3 + thr_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + thr_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_6_tr, lmm3_sa_tr)
```

## Deprivation

Autonomy (B1SPWBA2)
```{r}
# Composite
lmm1_1_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_autonomy_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + dep_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_1_dep, lmm1_autonomy_dep)

# EM
lmm2_1_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBA2+ (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_autonomy_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + dep_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_1_dep, lmm2_autonomy_dep)

# EF
lmm3_1_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_autonomy_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBA2 + dep_total*B1SPWBA2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_1_dep, lmm3_autonomy_dep)
```

Environmental Mastery (B1SPWBE2)
```{r}
# Composite
lmm1_2_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_mastery_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + dep_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_2_dep, lmm1_mastery_dep)

# EM
lmm2_2_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_mastery_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + dep_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_2_dep, lmm2_mastery_dep)

# EF
lmm3_2_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_mastery_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBE2 + dep_total*B1SPWBE2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_2_dep, lmm3_mastery_dep)

```



Personal Growth (B1SPWBG2)
```{r}
# Composite
lmm1_3_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pg_dep= lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + dep_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm1_3_dep, lmm1_pg_dep)


# EM
lmm2_3_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pg_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + dep_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm2_3_dep, lmm2_pg_dep)


# EF
lmm3_3_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pg_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBG2 + dep_total*B1SPWBG2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
anova(lmm3_3_dep, lmm3_pg_dep)
```

Positive Relations with Others (B1SPWBR2)
```{r}
# Composite
lmm1_4_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pr_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + dep_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_4_dep, lmm1_pr_dep)


# EM
lmm2_4_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pr_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + dep_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_4_dep, lmm2_pr_dep)

# EF
lmm3_4_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pr_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBR2 + dep_total*B1SPWBR2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_4_dep, lmm3_pr_dep)
```

Purpose in Life (B1SPWBU2)
```{r}
# Composite
lmm1_5_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_pl_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + dep_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_5_dep, lmm1_pl_dep)


# EM
lmm2_5_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_pl_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + dep_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_5_dep, lmm2_pl_dep)

# EF
lmm3_5_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_pl_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBU2 + dep_total*B1SPWBU2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_5_dep, lmm3_pl_dep)
```


Self-Acceptance (B1SPWBS2)
```{r}
# Composite
lmm1_6_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm1_sa_dep = lmer(D3TCOMP ~ B3TCOMPZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + dep_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm1_6_dep, lmm1_sa_dep)


# EM
lmm2_6_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm2_sa_dep = lmer(D3TEM ~ B3TEMZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + dep_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm2_6_dep, lmm2_sa_dep)

# EF
lmm3_6_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed +  B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)
lmm3_sa_dep = lmer(D3TEF ~ B3TEFZ3 + dep_total + B1PRSEX + B1PAGE_M2 + B1PF7A + B1PTSEI + B1PA39 + B4ALCOH + D1PB19 + B4HMETMW + B1SA11W + yr_lapsed + B1SPWBS2 + dep_total*B1SPWBS2 + (1|M2FAMNUM), REML = FALSE, data = full_df_no_invalid)

anova(lmm3_6_dep, lmm3_sa_dep)
```




